@let isLoggedIn = authStore.isLoggedIn();
<nz-layout>
  @if (isMobile) {
    <nz-header style="height: 40px; padding: 0 16px">
      <div class="w-100 h-100 d-flex justify-content-between align-items-center">
        <div style="flex: 1">
          @if (isLoggedIn) {
            <fa-icon [icon]="menu" (click)="sideMenuClosed = !sideMenuClosed"></fa-icon>
          }
        </div>

        <div style="font-size: 18px">{{ mobileHeaderService.title$ | async }}</div>

        <div style="flex: 1" class="d-flex w-100 justify-content-end">
          @if (mobileHeaderService.showCreateButton$ | async) {
            <fa-icon [icon]="plus" (click)="mobileHeaderService.clickedButton()"></fa-icon>
          }
        </div>
      </div>
    </nz-header>
  }

  @if (!isMobile && isLoggedIn && sideMenuClosed !== undefined) {
    <nz-sider
      nzCollapsible
      [(nzCollapsed)]="sideMenuClosed"
      (nzCollapsedChange)="authStore.updateUserConfig({ sideMenuOpen: !$event })"
      nzWidth="200px"
      [nzCollapsedWidth]="collapsedWidth"
    >
      <app-side-menu
        [routes]="authStore.userRoutes()"
        [sideMenuClosed]="sideMenuClosed"
        (closeSideMenu)="closeSideMenu()"
        [isMobile]="isMobile"
      ></app-side-menu>
    </nz-sider>
  }

  <nz-layout>
    @if (isMobile && sideMenuClosed !== undefined) {
      <nz-sider
        nzCollapsible
        [(nzCollapsed)]="sideMenuClosed"
        [nzTrigger]="null"
        (nzCollapsedChange)="authStore.updateUserConfig({ sideMenuOpen: !$event }, false)"
        nzWidth="200px"
        [nzCollapsedWidth]="collapsedWidth"
      >
        <app-side-menu
          [routes]="authStore.userRoutes()"
          [sideMenuClosed]="sideMenuClosed"
          (closeSideMenu)="closeSideMenu(false)"
          [isMobile]="isMobile"
        ></app-side-menu>
      </nz-sider>
    }

    <nz-content style="{{ isMobile ? 'margin-bottom: 69px' : '' }}" (click)="closeSideIfMobile()">
      <div style="min-height: calc(100vh - {{ isMobile ? '109px' : '69px' }})">
        @if (loading) {
          <div
            class="w-100 d-flex justify-content-center align-items-center"
            style="height: calc(100vh - {{ isMobile ? '109px' : '69px' }})"
          >
            <nz-spin></nz-spin>
          </div>
        } @else {
          <router-outlet></router-outlet>
        }
      </div>
    </nz-content>

    @if (isMobile) {
      <nz-footer class="footer-shadow mobile-footer" style="z-index: 1000">
        <app-mobile-footer></app-mobile-footer>
      </nz-footer>
    } @else {
      <nz-footer class="footer-shadow">Big Mike Â©2024</nz-footer>
    }
  </nz-layout>
</nz-layout>
