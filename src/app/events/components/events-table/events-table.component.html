<nz-table #eventsTableTag [nzData]="_events" nzSize="default" [nzFrontPagination]="false">
  <thead>
  <tr>
    <th nzWidth="60px"></th>
    <th>Name</th>
    <th>Date</th>
    <th>Spots Filled</th>
  </tr>
  </thead>
  <tbody>
  <ng-container *ngFor="let event of eventsTable?.data">
    <tr>
      <td [nzExpand]="expandSet.has(event.id)" (nzExpandChange)="onExpandChange(event.id, $event)"></td>
      <td>
        <div *ngIf="event.deletedAt" class="text-warning" style="font-style: italic">Archived</div>
        {{event.name}}
      </td>
      <td>{{event.eventDate | date : 'short'}}</td>
      <td [ngSwitch]="event.limitParticipants" *ngLet="event | participantsGoing as participantsGoing">
        <div class="d-flex spot-progress" *ngSwitchCase="true">

          <nz-progress [nzPercent]="getPercent(participantsGoing, event.numOfPeople)" [nzSteps]="event.numOfPeople"
                       [nzShowInfo]="false" nzStrokeColor="#1890ff"></nz-progress>
          <div class="ms-2">{{participantsGoing.length}}/{{event.numOfPeople}}</div>

        </div>

        <div *ngSwitchCase="false">{{participantsGoing.length}} participant{{participantsGoing.length === 1 ? '' : 's'}}</div>
      </td>
    </tr>
    <tr [nzExpand]="expandSet.has(event.id)">
      <nz-collapse>

        <div class="w-100 p-2">

          <div class="mb-3 w-100 d-flex buttons" [ngSwitch]="!!event.deletedAt">

            <ng-container *ngSwitchCase="true">

              <!--              <button nz-button>-->
              <!--                <fa-icon [icon]="restore" size="1x"></fa-icon>-->
              <!--              </button>-->

            </ng-container>

            <ng-container *ngSwitchCase="false">

              <div class="d-flex justify-content-evenly w-100">

                <div class="d-flex flex-column align-items-center" (click)="copyToClipboard(event)">
                  <fa-icon class="text-info" [icon]="copy"></fa-icon>
                  Copy
                </div>

                <a class="d-flex flex-column align-items-center" [href]="event.eventUrl" target="_blank"
                   style="text-decoration: none; color: white">
                  <fa-icon class="text-warning" [icon]="open"></fa-icon>
                  Open
                </a>

                <div class="d-flex flex-column align-items-center" (click)="editEvent.emit(event)">
                  <fa-icon class="text-primary" [icon]="edit"></fa-icon>
                  Edit
                </div>

                <div class="d-flex flex-column align-items-center" nz-popconfirm nzPopconfirmTitle="Are you sure?"
                     (nzOnConfirm)="archiveEvent.emit(event)">
                  <fa-icon class="text-danger" [icon]="archive"></fa-icon>
                  Archive
                </div>

              </div>

            </ng-container>

          </div>

          <nz-list nzBordered *ngIf="event.eventParticipants.length > 0">
            <nz-list-item *ngFor="let participant of event.eventParticipants">
              <div>
                <fa-icon *ngIf="participant.isGoing" [icon]="participantGoing" class="text-success me-2"></fa-icon>
                <fa-icon *ngIf="!participant.isGoing" [icon]="participantNotGoing" class="text-danger me-2"></fa-icon>
                {{participant.name}}
              </div>
              <fa-icon [icon]="participantChange" (click)="editParticipant.emit(participant)"></fa-icon>
            </nz-list-item>
          </nz-list>

        </div>

      </nz-collapse>
    </tr>
  </ng-container>
  </tbody>

</nz-table>

