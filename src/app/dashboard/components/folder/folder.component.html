<div class="folder p-4 m-2">
  <div class="d-flex justify-content-between mb-3">
    <div class="d-flex align-items-center">
      @if (editMode) {
        <button nz-button nzType="text" (click)="folderStore.moveFolder({ folder, direction: -1 })">
          <fa-icon [icon]="left"></fa-icon>
        </button>
      }

      @if (editMode) {
        <button class="me-2" nz-button nzType="text" (click)="folderStore.moveFolder({ folder, direction: 1 })">
          <fa-icon [icon]="right"></fa-icon>
        </button>
      }

      <h4 class="m-0">{{ folder.name }}</h4>
    </div>

    @if (editMode) {
      <div class="d-flex">
        <button nz-button nzType="text" (click)="addNewSite()" nz-tooltip nzTooltipTitle="Add New Site">
          <fa-icon [icon]="add"></fa-icon>
        </button>

        <button nz-button nzType="text" (click)="openFolderModal.emit(folder.id)">
          <fa-icon [icon]="edit"></fa-icon>
        </button>

        <button
          nz-button
          nzType="text"
          nz-popconfirm
          nzPopconfirmTitle="Are you sure you want to delete this folder?"
          (nzOnConfirm)="deleteFolder()"
        >
          <fa-icon [icon]="trash"></fa-icon>
        </button>
      </div>
    }
  </div>

  <div cdkDropList (cdkDropListDropped)="dropSite({ event: $event })" class="sites-border">
    @for (site of sortedSites(); track site.id) {
      <app-site [site]="site" [editMode]="editMode" (openSiteModal)="openSiteModal.emit($event)"></app-site>
    }
  </div>
</div>
